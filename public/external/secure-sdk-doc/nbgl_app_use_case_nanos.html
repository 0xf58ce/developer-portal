<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Embedded SDK: Predefined Application Use-cases API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Embedded SDK
   </div>
   <div id="projectbrief">Embedded SDK</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">Embedded SDK</a></li><li class="navelem"><a class="el" href="nbgl_mainpage.html">New BOLOS Graphic API</a></li>  </ul>
</div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Predefined Application Use-cases API </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="nbgl_use_case_intro"></a>
Introduction</h1>
<p>This chapter describes the Application Use-cases API of Advanced BOLOS Graphic Library.</p>
<p>This layer offers a simplified view of some typical use-cases of display in an Application running on Stax. For example, a use-case can be:</p>
<ul>
<li>Reviewing a transaction/message</li>
<li>Reviewing details on a given data of a transaction/message</li>
<li>Displaying pages of settings</li>
</ul>
<p>A full description of each predefined use-case can be found in this document</p>
<h1><a class="anchor" id="nbgl_use_case_concepts"></a>
Concepts</h1>
<p>This layer uses the Step API described in nbgl_step, but offers to developer more than a single step.</p>
<p>The goal is to simplify the usage of NBGL, but also to offer a better homogeneity across applications, by pushing developers to use common API for common use-cases.</p>
<p>So that not only the look of the pages but also their transitions look the same. Which should be a real help for end-users, getting more and more familiar with the user experience of applications.</p>
<h2><a class="anchor" id="nbgl_use_case_example_1"></a>
Example 1: transaction review</h2>
<p><img src="UseCase-Review1.png" alt="" height="300" class="inline" title="caption"/></p>
<p>In this example, a transaction review consists in 3 successive pages, and can be seen as a use-case</p>
<h2><a class="anchor" id="nbgl_use_case_example_2"></a>
Example 2: settings pages</h2>
<p><img src="UseCase-Settings1.png" alt="" height="300" class="inline" title="caption"/></p>
<p>In this example, a parsing the settings (single level) consists in 2 pages, and can be seen as another use-case.</p>
<h1><a class="anchor" id="nbgl_use_cases"></a>
Use Cases</h1>
<p>A few APIs are available to draw typical Use-Cases, such as:</p>
<ul>
<li>for Home Screen:<ul>
<li><a class="el" href="nbgl__use__case_8h.html#a96af0a08b9b41c27526b80df448abe88">nbgl_useCaseHome()</a> to draw the home screen of an application (see <a class="el" href="nbgl_app_use_case_nanos.html#use_case_home">Home screen Use Case</a>)</li>
</ul>
</li>
<li>for Settings:<ul>
<li><a class="el" href="nbgl__use__case_8h.html#a1d48546831e20e82f14f8a069897a80e">nbgl_useCaseSettings()</a> to draw a level of settings pages (see <a class="el" href="nbgl_app_use_case_nanos.html#use_case_settings">Settings Use Case</a>)</li>
<li><a class="el" href="nbgl__use__case_8h.html#a6c70e8409832531cb83c75c5c376ee18">nbgl_useCaseSpinner()</a> to draw an infinite spinner page (see <a class="el" href="nbgl_app_use_case_nanos.html#use_case_spinner">Spinner Use Case</a>)</li>
</ul>
</li>
<li>for most used reviews:<ul>
<li><a class="el" href="nbgl__use__case_8h.html#a6c43db694bb58022d8e27dbf5e1f85b6">nbgl_useCaseStaticReview()</a> to draw the pages of a regular review, when all info are available from the beginning (see <a class="el" href="nbgl_app_use_case_nanos.html#use_case_static_review">Static Review Use Case</a>)</li>
<li><a class="el" href="nbgl__use__case_8h.html#a98e4f4edf3e9105b893dd699a317585d">nbgl_useCaseRegularReview()</a> to draw the pages of a regular review (all pages but the cover one) (see <a class="el" href="nbgl_app_use_case_nanos.html#use_case_regular_review">Regular Review Use Case</a>)</li>
</ul>
</li>
<li>for rare reviews:<ul>
<li><a class="el" href="nbgl__use__case_8h.html#a14b8ec4e4b240b8f06b6f8788f45bb0c">nbgl_useCaseForwardOnlyReview()</a> to draw the pages of a forward-only review (without back key) (see <a class="el" href="nbgl_app_use_case_nanos.html#use_case_forward_only_review">Forward only Review Use Case</a>)</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="use_case_home"></a>
Home screen Use Case</h2>
<p><img src="UseCase-Home.png" alt="" height="300" class="inline" title="caption"/></p>
<p>Ledger would like all application to have the same home screen, so the <a class="el" href="nbgl__use__case_8h.html#a96af0a08b9b41c27526b80df448abe88">nbgl_useCaseHome()</a> function enables to create such a page, the only configurable parameters being:</p>
<ul>
<li>the application name</li>
<li>the application icon</li>
<li>the tagline, a text under app name (if NULL, it will be "This app enables signing transactions on the &lt;appName&gt; network.")</li>
<li>the callbacks when touching <em>quit</em> or <em>top-right</em> buttons</li>
<li>the type of top-right button (info or settings)</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">extern</span> <span class="keyword">const</span> <a class="code hl_typedef" href="nbgl__types_8h.html#a7724587bc3e14c498ed49c3e70c365d6">nbgl_icon_details_t</a> *myAppIcon;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> myAppSettings(<span class="keywordtype">void</span>) {</div>
<div class="line">    <span class="comment">// draw settings page here</span></div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">void</span> onQuit(<span class="keywordtype">void</span>) {</div>
<div class="line">    <span class="comment">// exit app here</span></div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">void</span> appMain(<span class="keywordtype">void</span>) {</div>
<div class="line">  <a class="code hl_function" href="nbgl__use__case_8h.html#a96af0a08b9b41c27526b80df448abe88">nbgl_useCaseHome</a>(<span class="stringliteral">&quot;MyApp&quot;</span>,</div>
<div class="line">                   &amp;myAppIcon,</div>
<div class="line">                   NULL,</div>
<div class="line">                   <span class="keyword">true</span>, <span class="comment">// with settings button</span></div>
<div class="line">                   myAppSettings,</div>
<div class="line">                   onQuit);</div>
<div class="line">}</div>
<div class="ttc" id="anbgl__types_8h_html_a7724587bc3e14c498ed49c3e70c365d6"><div class="ttname"><a href="nbgl__types_8h.html#a7724587bc3e14c498ed49c3e70c365d6">nbgl_icon_details_t</a></div><div class="ttdeci">struct PACKED__ nbgl_icon_details_s nbgl_icon_details_t</div><div class="ttdoc">Represents all information about an icon.</div></div>
<div class="ttc" id="anbgl__use__case_8h_html_a96af0a08b9b41c27526b80df448abe88"><div class="ttname"><a href="nbgl__use__case_8h.html#a96af0a08b9b41c27526b80df448abe88">nbgl_useCaseHome</a></div><div class="ttdeci">void nbgl_useCaseHome(const char *appName, const nbgl_icon_details_t *appIcon, const char *appVersion, const char *tagline, nbgl_callback_t aboutCallback, nbgl_callback_t quitCallback)</div><div class="ttdoc">draws the home page of an app (page on which we land when launching it from dashboard)</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__use__case__nanos_8c_source.html#l00301">nbgl_use_case_nanos.c:301</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="use_case_settings"></a>
Settings Use Case</h2>
<p><img src="UseCase-Settings1.png" alt="" height="300" class="inline" title="caption"/></p>
<p>Usually settings (or information) of an application consist in a list of pages, each page containing:</p>
<ul>
<li>some radio buttons to make a choice</li>
<li>some switches for various configuration</li>
<li>a list of information organized by pairs [info_name, info_value]</li>
</ul>
<p>The API to initiate the display of the series of pages is <a class="el" href="nbgl__use__case_8h.html#a1d48546831e20e82f14f8a069897a80e">nbgl_useCaseSettings()</a>, providing:</p>
<ul>
<li>the title of the settings series</li>
<li>the page in which to start</li>
<li>the number of pages</li>
<li>a boolean to indicate whether the title is touchable or not (if touchable, it is used to quit the series, so no Quit button in navigation bar)</li>
<li>a callback called when the quit button (or touchable title) is touched</li>
<li>a navigation callback called when navigation arrow buttons are touched (and to fill the initial page), to retrieve the content of the page</li>
<li>a last callback called when any of the controls provided in content is touched</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>All tokens used for the given "settings" must be greater or equal than <a class="el" href="nbgl__use__case_8h.html#ab17d3c66e783f1a3b425e9b4ee41615c">FIRST_USER_TOKEN</a></dd></dl>
<p><img src="UseCase-Settings2.png" alt="" height="300" class="inline" title="caption"/></p>
<p>Here is the source code to display the first example of settings:</p>
<div class="fragment"><div class="line"><span class="keyword">enum</span> {</div>
<div class="line">  SWITCH1_TOKEN = <a class="code hl_define" href="nbgl__use__case_8h.html#ab17d3c66e783f1a3b425e9b4ee41615c">FIRST_USER_TOKEN</a>,</div>
<div class="line">  SWITCH2_TOKEN,</div>
<div class="line">  SWITCH3_TOKEN</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <a class="code hl_struct" href="structnbgl__layoutSwitch__t.html">nbgl_layoutSwitch_t</a> switches[] = {</div>
<div class="line">  {</div>
<div class="line">    .<a class="code hl_variable" href="structnbgl__layoutSwitch__t.html#a93f167dc0151262e0d47aa2689f8c4cf">initState</a> = <span class="keyword">false</span>,</div>
<div class="line">    .text = <span class="stringliteral">&quot;Blind signing&quot;</span>,</div>
<div class="line">    .subText = <span class="stringliteral">&quot;Enable transaction blind\n&quot;</span> <span class="stringliteral">&quot;signing&quot;</span>,</div>
<div class="line">    .token = SWITCH1_TOKEN,</div>
<div class="line">    .tuneId = TUNE_TAP_CASUAL</div>
<div class="line">  },</div>
<div class="line">  {</div>
<div class="line">    .initState = <span class="keyword">true</span>,</div>
<div class="line">    .text = <span class="stringliteral">&quot;Debug&quot;</span>,</div>
<div class="line">    .subText = <span class="stringliteral">&quot;Display contract data details&quot;</span>,</div>
<div class="line">    .token = SWITCH2_TOKEN,</div>
<div class="line">    .tuneId = TUNE_TAP_CASUAL</div>
<div class="line">  },</div>
<div class="line">  {</div>
<div class="line">    .initState = <span class="keyword">true</span>,</div>
<div class="line">    .text = <span class="stringliteral">&quot;Nonce&quot;</span>,</div>
<div class="line">    .subText = <span class="stringliteral">&quot;Display account nonce\n&quot;</span> <span class="stringliteral">&quot;in transaction&quot;</span>,</div>
<div class="line">    .token = SWITCH3_TOKEN,</div>
<div class="line">    .tuneId = TUNE_TAP_CASUAL</div>
<div class="line">  },</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* infoTypes[] = {</div>
<div class="line">  <span class="stringliteral">&quot;Version&quot;</span></div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* infoContents[] = {</div>
<div class="line">  <span class="stringliteral">&quot;1.9.18&quot;</span></div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">bool</span> navCallback(<a class="code hl_typedef" href="usbd__conf_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> page, <a class="code hl_struct" href="structnbgl__stepDesc__s.html">nbgl_pageContent_t</a> *content) {</div>
<div class="line">  <span class="comment">// the first settings page contains 3 switches</span></div>
<div class="line">  <span class="keywordflow">if</span> (page == 0) {</div>
<div class="line">    content-&gt;type = <a class="code hl_enumvalue" href="nbgl__page_8h.html#a740963f8a57ecdc0e0f66a10f263e6d4aaa3b4a61cc5be5e90bd2c1ab32f13373">SWITCHES_LIST</a>;</div>
<div class="line">    content-&gt;switchesList.nbSwitches = 3;</div>
<div class="line">    content-&gt;switchesList.switches = (<a class="code hl_struct" href="structnbgl__layoutSwitch__t.html">nbgl_layoutSwitch_t</a>*)switches;</div>
<div class="line">  }</div>
<div class="line">  <span class="comment">// the second settings page contains only the version of the app</span></div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (page == 1) {</div>
<div class="line">    content-&gt;type = <a class="code hl_enumvalue" href="nbgl__page_8h.html#a740963f8a57ecdc0e0f66a10f263e6d4ad372699e9303e56cf4622a00eea34032">INFOS_LIST</a>;</div>
<div class="line">    content-&gt;infosList.nbInfos = 1;</div>
<div class="line">    content-&gt;infosList.infoTypes = infoTypes;</div>
<div class="line">    content-&gt;infosList.infoContents = infoContents;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> {</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">  }</div>
<div class="line">  <span class="comment">// valid page so return true</span></div>
<div class="line">  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> controlsCallback(<span class="keywordtype">int</span> token, <a class="code hl_typedef" href="usbd__conf_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> index) {</div>
<div class="line">  <span class="keywordflow">if</span> (token == SWITCH1_TOKEN) {</div>
<div class="line">    <span class="comment">// First switch touched</span></div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> myAppSettings(<span class="keywordtype">void</span>) {</div>
<div class="line">  <span class="comment">// draw the settings Use Case (2 pages), starting at page 0</span></div>
<div class="line">  <a class="code hl_function" href="nbgl__use__case_8h.html#a1d48546831e20e82f14f8a069897a80e">nbgl_useCaseSettings</a>(<span class="stringliteral">&quot;Ethereum settings&quot;</span>,0,2,<span class="keyword">false</span>,appMain,navCallback,controlsCallback);</div>
<div class="line">}</div>
<div class="ttc" id="anbgl__page_8h_html_a740963f8a57ecdc0e0f66a10f263e6d4aaa3b4a61cc5be5e90bd2c1ab32f13373"><div class="ttname"><a href="nbgl__page_8h.html#a740963f8a57ecdc0e0f66a10f263e6d4aaa3b4a61cc5be5e90bd2c1ab32f13373">SWITCHES_LIST</a></div><div class="ttdeci">@ SWITCHES_LIST</div><div class="ttdoc">list of switches with descriptions</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__page_8h_source.html#l00053">nbgl_page.h:53</a></div></div>
<div class="ttc" id="anbgl__page_8h_html_a740963f8a57ecdc0e0f66a10f263e6d4ad372699e9303e56cf4622a00eea34032"><div class="ttname"><a href="nbgl__page_8h.html#a740963f8a57ecdc0e0f66a10f263e6d4ad372699e9303e56cf4622a00eea34032">INFOS_LIST</a></div><div class="ttdeci">@ INFOS_LIST</div><div class="ttdoc">list of infos with titles</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__page_8h_source.html#l00054">nbgl_page.h:54</a></div></div>
<div class="ttc" id="anbgl__use__case_8h_html_a1d48546831e20e82f14f8a069897a80e"><div class="ttname"><a href="nbgl__use__case_8h.html#a1d48546831e20e82f14f8a069897a80e">nbgl_useCaseSettings</a></div><div class="ttdeci">void nbgl_useCaseSettings(uint8_t initPage, uint8_t nbPages, nbgl_callback_t quitCallback, nbgl_navCallback_t navCallback, nbgl_actionCallback_t actionCallback)</div><div class="ttdoc">Draws the settings pages of an app with as many pages as given For each page, the given navCallback w...</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__use__case__nanos_8c_source.html#l00343">nbgl_use_case_nanos.c:343</a></div></div>
<div class="ttc" id="anbgl__use__case_8h_html_ab17d3c66e783f1a3b425e9b4ee41615c"><div class="ttname"><a href="nbgl__use__case_8h.html#ab17d3c66e783f1a3b425e9b4ee41615c">FIRST_USER_TOKEN</a></div><div class="ttdeci">#define FIRST_USER_TOKEN</div><div class="ttdoc">when using controls in page content (nbgl_pageContent_t), this is the first token value usable for th...</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__use__case_8h_source.html#l00031">nbgl_use_case.h:31</a></div></div>
<div class="ttc" id="astructnbgl__layoutSwitch__t_html"><div class="ttname"><a href="structnbgl__layoutSwitch__t.html">nbgl_layoutSwitch_t</a></div><div class="ttdoc">This structure contains info to build a switch (on the right) with a description (on the left),...</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__layout_8h_source.html#l00165">nbgl_layout.h:165</a></div></div>
<div class="ttc" id="astructnbgl__layoutSwitch__t_html_a93f167dc0151262e0d47aa2689f8c4cf"><div class="ttname"><a href="structnbgl__layoutSwitch__t.html#a93f167dc0151262e0d47aa2689f8c4cf">nbgl_layoutSwitch_t::initState</a></div><div class="ttdeci">nbgl_state_t initState</div><div class="ttdoc">initial state of the switch</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__layout_8h_source.html#l00169">nbgl_layout.h:169</a></div></div>
<div class="ttc" id="astructnbgl__stepDesc__s_html"><div class="ttname"><a href="structnbgl__stepDesc__s.html">nbgl_stepDesc_s</a></div><div class="ttdoc">Structure containing all specific information when creating a NBGL step.</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__flow_8h_source.html#l00043">nbgl_flow.h:43</a></div></div>
<div class="ttc" id="ausbd__conf_8h_html_aba7bc1797add20fe3efdf37ced1182c5"><div class="ttname"><a href="usbd__conf_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a></div><div class="ttdeci">unsigned char uint8_t</div><div class="ttdef"><b>Definition:</b> <a href="usbd__conf_8h_source.html#l00053">usbd_conf.h:53</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="use_case_regular_review"></a>
Regular Review Use Case</h2>
<p><img src="UseCase-Review1.png" alt="" height="300" class="inline" title="caption"/></p>
<p>Usually transaction/message reviews consist in a sequence of pages, each page containing:</p>
<ul>
<li>one or several tag/value pair or a long press button for the final page, to validate the review</li>
<li>a footer to reject the review</li>
</ul>
<p>To navigate between pages, a back arrow is available on the top-left of the screen, and the whole page is "tappable".</p>
<p>The API to initiate the display of the series of pages is <a class="el" href="nbgl__use__case_8h.html#a98e4f4edf3e9105b893dd699a317585d">nbgl_useCaseRegularReview()</a>, providing:</p>
<ul>
<li>the page in which to start (usually 0)</li>
<li>the number of pages (if unknown, set to 0)</li>
<li>a "button" callback called when a potential button in the page's content is touched</li>
<li>a navigation callback called when back key or screen is "tapped" , to retrieve the content of the previous/next page. It is also called to fill the initial page.</li>
<li>a callback called when the long press button (with param true) on last page or the footer to reject is used (with param false)</li>
</ul>
<p>If the number of pages is unknown at the beginning, no progress indicator will be display on top of the screen.</p>
<p>Here is the code to display something similar to example picture:</p>
<div class="fragment"><div class="line"><span class="comment">// 4 pairs of tag/value to display</span></div>
<div class="line"><span class="keyword">static</span> <a class="code hl_struct" href="structnbgl__layoutTagValue__t.html">nbgl_layoutTagValue_t</a> pairs[4];</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> onConfirmAbandon(<span class="keywordtype">void</span>) {</div>
<div class="line">  <span class="comment">// display a status page and go back to main</span></div>
<div class="line">  nbgl_useCaseStatus(<span class="stringliteral">&quot;Transaction rejected&quot;</span>,<span class="keyword">false</span>,appMain);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// called when long press button on 3rd page is long-touched or when reject footer is touched</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> reviewChoice(<span class="keywordtype">bool</span> confirm) {</div>
<div class="line">  <span class="keywordflow">if</span> (confirm) {</div>
<div class="line">    <span class="comment">// display a status page and go back to main</span></div>
<div class="line">    nbgl_useCaseStatus(<span class="stringliteral">&quot;TRANSACTION\nSIGNED&quot;</span>,<span class="keyword">true</span>,appMain);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> {</div>
<div class="line">    nbgl_useCaseConfirm(<span class="stringliteral">&quot;Reject transaction?&quot;</span>,<span class="stringliteral">&quot;Yes, Reject&quot;</span>,<span class="stringliteral">&quot;Go back to transaction&quot;</span>,onConfirmAbandon);</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// called to get the content of the given page</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">bool</span> displayTransactionPage(<a class="code hl_typedef" href="usbd__conf_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> page, <a class="code hl_struct" href="structnbgl__stepDesc__s.html">nbgl_pageContent_t</a> *content) {</div>
<div class="line">  <span class="keywordflow">if</span> (page == 0) {</div>
<div class="line">    <span class="comment">// the first page contains 3 tag/value pairs</span></div>
<div class="line">    content-&gt;type = <a class="code hl_enumvalue" href="nbgl__page_8h.html#a740963f8a57ecdc0e0f66a10f263e6d4ad4992814ce29d2a2b131464f0b72523c">TAG_VALUE_LIST</a>;</div>
<div class="line">    content-&gt;tagValueList.nbPairs = 3;</div>
<div class="line">    content-&gt;tagValueList.pairs = (<a class="code hl_struct" href="structnbgl__layoutTagValue__t.html">nbgl_layoutTagValue_t</a> *)pairs;</div>
<div class="line">    content-&gt;tagValueList.smallCaseForValue = <span class="keyword">false</span>;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (page == 1) {</div>
<div class="line">    <span class="comment">// the second page contains 1 tag/value pair</span></div>
<div class="line">    content-&gt;type = <a class="code hl_enumvalue" href="nbgl__page_8h.html#a740963f8a57ecdc0e0f66a10f263e6d4ad4992814ce29d2a2b131464f0b72523c">TAG_VALUE_LIST</a>;</div>
<div class="line">    content-&gt;tagValueList.nbPairs = 1;</div>
<div class="line">    content-&gt;tagValueList.pairs = (<a class="code hl_struct" href="structnbgl__layoutTagValue__t.html">nbgl_layoutTagValue_t</a> *)&amp;pairs[3];</div>
<div class="line">    content-&gt;tagValueList.smallCaseForValue = <span class="keyword">false</span>;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (page == 2) {</div>
<div class="line">    <span class="comment">// the last page must contain a long press button</span></div>
<div class="line">    content-&gt;type = <a class="code hl_enumvalue" href="nbgl__page_8h.html#a740963f8a57ecdc0e0f66a10f263e6d4a2b62aad3b320b6e0073e7be25da19a72">INFO_LONG_PRESS</a>,</div>
<div class="line">    content-&gt;infoLongPress.<a class="code hl_variable" href="structnbgl__stepDesc__s.html#a7bca9e9f1e3de62a3f081270abfb157d">icon</a> = &amp;myAppIcon;</div>
<div class="line">    content-&gt;infoLongPress.<a class="code hl_variable" href="structnbgl__stepDesc__s.html#af652748bd4e0a1d796e26fa547c0eeea">text</a> = <span class="stringliteral">&quot;Confirm transaction\nMyCoin send&quot;</span>;</div>
<div class="line">    content-&gt;infoLongPress.longPressText = <span class="stringliteral">&quot;Hold to send&quot;</span>;</div>
<div class="line">    content-&gt;infoLongPress.longPressToken = VALIDATE_TRANSACTION_TOKEN;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> {</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">  }</div>
<div class="line">  <span class="comment">// valid page so return true</span></div>
<div class="line">  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> reviewContinue(<span class="keywordtype">void</span>) {</div>
<div class="line">  <span class="comment">// review on 3 pages, starting at 0</span></div>
<div class="line">  <a class="code hl_function" href="nbgl__use__case_8h.html#a98e4f4edf3e9105b893dd699a317585d">nbgl_useCaseRegularReview</a>(0, 3, <span class="stringliteral">&quot;Reject transaction&quot;</span>,</div>
<div class="line">                            NULL, <span class="comment">// no buttons because no value is too long to fit</span></div>
<div class="line">                            displayTransactionPage, reviewChoice);</div>
<div class="line">}</div>
<div class="ttc" id="anbgl__page_8h_html_a740963f8a57ecdc0e0f66a10f263e6d4a2b62aad3b320b6e0073e7be25da19a72"><div class="ttname"><a href="nbgl__page_8h.html#a740963f8a57ecdc0e0f66a10f263e6d4a2b62aad3b320b6e0073e7be25da19a72">INFO_LONG_PRESS</a></div><div class="ttdeci">@ INFO_LONG_PRESS</div><div class="ttdoc">a centered info and a long press button</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__page_8h_source.html#l00048">nbgl_page.h:48</a></div></div>
<div class="ttc" id="anbgl__page_8h_html_a740963f8a57ecdc0e0f66a10f263e6d4ad4992814ce29d2a2b131464f0b72523c"><div class="ttname"><a href="nbgl__page_8h.html#a740963f8a57ecdc0e0f66a10f263e6d4ad4992814ce29d2a2b131464f0b72523c">TAG_VALUE_LIST</a></div><div class="ttdeci">@ TAG_VALUE_LIST</div><div class="ttdoc">list of tag/value pairs</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__page_8h_source.html#l00050">nbgl_page.h:50</a></div></div>
<div class="ttc" id="anbgl__use__case_8h_html_a98e4f4edf3e9105b893dd699a317585d"><div class="ttname"><a href="nbgl__use__case_8h.html#a98e4f4edf3e9105b893dd699a317585d">nbgl_useCaseRegularReview</a></div><div class="ttdeci">void nbgl_useCaseRegularReview(uint8_t initPage, uint8_t nbPages, nbgl_navCallback_t navCallback)</div><div class="ttdoc">Draws a flow of pages of a review. Navigation is available for all pages For each page,...</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__use__case__nanos_8c_source.html#l00370">nbgl_use_case_nanos.c:370</a></div></div>
<div class="ttc" id="astructnbgl__layoutTagValue__t_html"><div class="ttname"><a href="structnbgl__layoutTagValue__t.html">nbgl_layoutTagValue_t</a></div><div class="ttdoc">This structure contains a [tag,value] pair.</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__layout_8h_source.html#l00218">nbgl_layout.h:218</a></div></div>
<div class="ttc" id="astructnbgl__stepDesc__s_html_a7bca9e9f1e3de62a3f081270abfb157d"><div class="ttname"><a href="structnbgl__stepDesc__s.html#a7bca9e9f1e3de62a3f081270abfb157d">nbgl_stepDesc_s::icon</a></div><div class="ttdeci">const nbgl_icon_details_t * icon</div><div class="ttdoc">icon to display in step (text must be single-page)</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__flow_8h_source.html#l00048">nbgl_flow.h:48</a></div></div>
<div class="ttc" id="astructnbgl__stepDesc__s_html_af652748bd4e0a1d796e26fa547c0eeea"><div class="ttname"><a href="structnbgl__stepDesc__s.html#af652748bd4e0a1d796e26fa547c0eeea">nbgl_stepDesc_s::text</a></div><div class="ttdeci">const char * text</div><div class="ttdoc">text to display in step (can be multi-pages if icon == NULL)</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__flow_8h_source.html#l00046">nbgl_flow.h:46</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="use_case_forward_only_review"></a>
Forward only Review Use Case</h2>
<p><img src="UseCase-ReviewForwardOnly.png" alt="" height="500" class="inline" title="caption"/></p>
<p>Some message/transaction reviews may be too long to be memorized, so it is only possible to move forward.</p>
<p>In this case, no back arrow is available on the top-left of the screen. Moreover, these reviews are always done with an unknown number of pages. A "Skip" button is added automatically in all pages except the one with Long Press button, to jump to last page, after an automatic confirmation modal window is displayed.</p>
<p>The API to initiate the display of the series of forward-only review pages is <a class="el" href="nbgl__use__case_8h.html#a14b8ec4e4b240b8f06b6f8788f45bb0c">nbgl_useCaseForwardOnlyReview()</a>, providing:</p>
<ul>
<li>a "button" callback called when a potential button in the page's content is touched</li>
<li>a navigation callback called when screen is "tapped" , to retrieve the content of the next page. It is also called to fill the initial page.</li>
<li>a callback called when the long press button (with param true) on last page or the footer to reject is used (with param false)</li>
</ul>
<p>Here is the code to display something similar to example picture:</p>
<div class="fragment"><div class="line"><span class="comment">// 5 pairs of tag/value to display</span></div>
<div class="line"><span class="keyword">static</span> <a class="code hl_struct" href="structnbgl__layoutTagValue__t.html">nbgl_layoutTagValue_t</a> pairs[5];</div>
<div class="line"> </div>
<div class="line"><span class="comment">// result of the rejection</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> onConfirmAbandon(<span class="keywordtype">void</span>) {</div>
<div class="line">  <span class="comment">// display a status page and go back to main</span></div>
<div class="line">  nbgl_useCaseStatus(<span class="stringliteral">&quot;Transaction rejected&quot;</span>,<span class="keyword">false</span>,appMain);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// called when long press button on 3rd page is long-touched or when reject footer is touched</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> reviewChoice(<span class="keywordtype">bool</span> confirm) {</div>
<div class="line">  <span class="keywordflow">if</span> (confirm) {</div>
<div class="line">    <span class="comment">// display a status page and go back to main</span></div>
<div class="line">    nbgl_useCaseStatus(<span class="stringliteral">&quot;TRANSACTION\nSIGNED&quot;</span>,<span class="keyword">true</span>,appMain);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> {</div>
<div class="line">    nbgl_useCaseConfirm(<span class="stringliteral">&quot;Reject transaction?&quot;</span>,<span class="stringliteral">&quot;Yes, Reject&quot;</span>,<span class="stringliteral">&quot;Go back to transaction&quot;</span>,onConfirmAbandon);</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// called to get the content of the given page</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">bool</span> displayTransactionPage(<a class="code hl_typedef" href="usbd__conf_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> page, <a class="code hl_struct" href="structnbgl__stepDesc__s.html">nbgl_pageContent_t</a> *content) {</div>
<div class="line">  <span class="keywordflow">if</span> (page == 0) {</div>
<div class="line">    <span class="comment">// the first page contains 3 tag/value pairs</span></div>
<div class="line">    content-&gt;type = <a class="code hl_enumvalue" href="nbgl__page_8h.html#a740963f8a57ecdc0e0f66a10f263e6d4ad4992814ce29d2a2b131464f0b72523c">TAG_VALUE_LIST</a>;</div>
<div class="line">    content-&gt;tagValueList.nbPairs = 3;</div>
<div class="line">    content-&gt;tagValueList.pairs = (<a class="code hl_struct" href="structnbgl__layoutTagValue__t.html">nbgl_layoutTagValue_t</a> *)pairs;</div>
<div class="line">    content-&gt;tagValueList.smallCaseForValue = <span class="keyword">false</span>;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (page == 1) {</div>
<div class="line">    <span class="comment">// the second page contains 2 tag/value pairs</span></div>
<div class="line">    content-&gt;type = <a class="code hl_enumvalue" href="nbgl__page_8h.html#a740963f8a57ecdc0e0f66a10f263e6d4ad4992814ce29d2a2b131464f0b72523c">TAG_VALUE_LIST</a>;</div>
<div class="line">    content-&gt;tagValueList.nbPairs = 2;</div>
<div class="line">    content-&gt;tagValueList.pairs = (<a class="code hl_struct" href="structnbgl__layoutTagValue__t.html">nbgl_layoutTagValue_t</a> *)&amp;pairs[3];</div>
<div class="line">    content-&gt;tagValueList.smallCaseForValue = <span class="keyword">false</span>;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (page == 2) {</div>
<div class="line">    <span class="comment">// the last page must contain a long press button</span></div>
<div class="line">    content-&gt;type = <a class="code hl_enumvalue" href="nbgl__page_8h.html#a740963f8a57ecdc0e0f66a10f263e6d4a2b62aad3b320b6e0073e7be25da19a72">INFO_LONG_PRESS</a>,</div>
<div class="line">    content-&gt;infoLongPress.<a class="code hl_variable" href="structnbgl__stepDesc__s.html#a7bca9e9f1e3de62a3f081270abfb157d">icon</a> = &amp;myAppIcon;</div>
<div class="line">    content-&gt;infoLongPress.<a class="code hl_variable" href="structnbgl__stepDesc__s.html#af652748bd4e0a1d796e26fa547c0eeea">text</a> = <span class="stringliteral">&quot;Confirm transaction\nMyCoin send&quot;</span>;</div>
<div class="line">    content-&gt;infoLongPress.longPressText = <span class="stringliteral">&quot;Hold to send&quot;</span>;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> {</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">  }</div>
<div class="line">  <span class="comment">// valid page so return true</span></div>
<div class="line">  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> reviewContinue(<span class="keywordtype">void</span>) {</div>
<div class="line">  <a class="code hl_function" href="nbgl__use__case_8h.html#a14b8ec4e4b240b8f06b6f8788f45bb0c">nbgl_useCaseForwardOnlyReview</a>(<span class="stringliteral">&quot;Reject transaction&quot;</span>,</div>
<div class="line">                            NULL, <span class="comment">// No details button so no callback needed</span></div>
<div class="line">                            displayTransactionPage, reviewChoice);</div>
<div class="line">}</div>
<div class="ttc" id="anbgl__use__case_8h_html_a14b8ec4e4b240b8f06b6f8788f45bb0c"><div class="ttname"><a href="nbgl__use__case_8h.html#a14b8ec4e4b240b8f06b6f8788f45bb0c">nbgl_useCaseForwardOnlyReview</a></div><div class="ttdeci">void nbgl_useCaseForwardOnlyReview(nbgl_navCallback_t navCallback)</div><div class="ttdoc">Draws a flow of pages of a review, without back key. It is possible to go to next page thanks to &quot;tap...</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__use__case__nanos_8c_source.html#l00393">nbgl_use_case_nanos.c:393</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="use_case_static_review"></a>
Static Review Use Case</h2>
<p><img src="UseCase-Review1.png" alt="" height="300" class="inline" title="caption"/></p>
<p>In some cases, the developer may know all tag/value pairs of a transaction when it is submitted.</p>
<p>In this case, what we call a "static" review can be used. It is similar to a regular review with know number of pages in terms of presentation and interactions with end-users, but much easier to use for developer.</p>
<p>Indeed, in this case, NBGL automatically computes the number of pages, and the pairs to draw in each page. In case of a tag/value pair too long to be fully displayed, the "more" button will be automatically drawn and its handling automatically performed by NBGL by building a detailed modal view.</p>
<p>The API to initiate the display of the series of pages is <a class="el" href="nbgl__use__case_8h.html#a6c43db694bb58022d8e27dbf5e1f85b6">nbgl_useCaseStaticReview()</a>, providing:</p>
<ul>
<li>the list of tag/value pairs (or a callback to get them one by one)</li>
<li>the texts to use in footer and in last page</li>
<li>a callback called when the long press button on last page or the footer to reject is used. The callback's param is true for confirmation, false for rejection.</li>
</ul>
<p>Here is the code to display something similar to example picture:</p>
<div class="fragment"><div class="line"><span class="comment">// 4 pairs of tag/value to display</span></div>
<div class="line"><span class="keyword">static</span> <a class="code hl_struct" href="structnbgl__layoutTagValue__t.html">nbgl_layoutTagValue_t</a> pairs[4];</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <a class="code hl_struct" href="structnbgl__layoutTagValueList__t.html">nbgl_layoutTagValueList_t</a> pairList = {</div>
<div class="line">  .<a class="code hl_variable" href="structnbgl__layoutTagValueList__t.html#a98c7f993e468e913e5b7cad7c2fdd429">nbMaxLinesForValue</a> = 0,</div>
<div class="line">  .nbPairs = 4,</div>
<div class="line">  .pairs = (<a class="code hl_struct" href="structnbgl__layoutTagValue__t.html">nbgl_layoutTagValue_t</a>*)pairs</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// result of the rejection choice</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> onConfirmAbandon(<span class="keywordtype">void</span>) {</div>
<div class="line">  <span class="comment">// display a status page and go back to main</span></div>
<div class="line">  nbgl_useCaseStatus(<span class="stringliteral">&quot;Transaction rejected&quot;</span>,<span class="keyword">false</span>,appMain);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// called when long press button on 3rd page is long-touched or when reject footer is touched</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> reviewChoice(<span class="keywordtype">bool</span> confirm) {</div>
<div class="line">  <span class="keywordflow">if</span> (confirm) {</div>
<div class="line">    <span class="comment">// display a status page and go back to main</span></div>
<div class="line">    nbgl_useCaseStatus(<span class="stringliteral">&quot;TRANSACTION\nSIGNED&quot;</span>,<span class="keyword">true</span>,appMain);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> {</div>
<div class="line">    <span class="comment">// display a confirmation to confirm/cancel rejection</span></div>
<div class="line">    nbgl_useCaseConfirm(<span class="stringliteral">&quot;Reject transaction?&quot;</span>,<span class="stringliteral">&quot;Yes, Reject&quot;</span>,<span class="stringliteral">&quot;Go back to transaction&quot;</span>,onConfirmAbandon);</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> reviewContinue(<span class="keywordtype">void</span>) {</div>
<div class="line">  <span class="keyword">static</span> <a class="code hl_struct" href="structnbgl__pageInfoLongPress__s.html">nbgl_pageInfoLongPress_t</a> infoLongPress = {</div>
<div class="line">    .<a class="code hl_variable" href="structnbgl__pageInfoLongPress__s.html#afad260d221831fb5304c99f1f79712e6">icon</a> = &amp;myAppIcon,</div>
<div class="line">    .text = <span class="stringliteral">&quot;Confirm transaction\nMyAppCoin send&quot;</span>,</div>
<div class="line">    .longPressText = <span class="stringliteral">&quot;Hold to send&quot;</span></div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// static review, providing the whole list of pairs</span></div>
<div class="line">  <a class="code hl_function" href="nbgl__use__case_8h.html#a6c43db694bb58022d8e27dbf5e1f85b6">nbgl_useCaseStaticReview</a>(&amp;pairList, &amp;infoLongPress, <span class="stringliteral">&quot;Reject transaction&quot;</span>, reviewChoice);</div>
<div class="line">}</div>
<div class="ttc" id="anbgl__use__case_8h_html_a6c43db694bb58022d8e27dbf5e1f85b6"><div class="ttname"><a href="nbgl__use__case_8h.html#a6c43db694bb58022d8e27dbf5e1f85b6">nbgl_useCaseStaticReview</a></div><div class="ttdeci">void nbgl_useCaseStaticReview(nbgl_layoutTagValueList_t *tagValueList, const nbgl_icon_details_t *icon, const char *reviewTitle, const char *acceptText, const char *rejectText, nbgl_choiceCallback_t callback)</div><div class="ttdoc">Draws a flow of pages of a review.</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__use__case__nanos_8c_source.html#l00414">nbgl_use_case_nanos.c:414</a></div></div>
<div class="ttc" id="astructnbgl__layoutTagValueList__t_html"><div class="ttname"><a href="structnbgl__layoutTagValueList__t.html">nbgl_layoutTagValueList_t</a></div><div class="ttdoc">This structure contains a list of [tag,value] pairs.</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__layout_8h_source.html#l00235">nbgl_layout.h:235</a></div></div>
<div class="ttc" id="astructnbgl__layoutTagValueList__t_html_a98c7f993e468e913e5b7cad7c2fdd429"><div class="ttname"><a href="structnbgl__layoutTagValueList__t.html#a98c7f993e468e913e5b7cad7c2fdd429">nbgl_layoutTagValueList_t::nbMaxLinesForValue</a></div><div class="ttdeci">uint8_t nbMaxLinesForValue</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__layout_8h_source.html#l00242">nbgl_layout.h:242</a></div></div>
<div class="ttc" id="astructnbgl__pageInfoLongPress__s_html"><div class="ttname"><a href="structnbgl__pageInfoLongPress__s.html">nbgl_pageInfoLongPress_s</a></div><div class="ttdoc">This structure contains data to build a centered info + long press button page content.</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__flow_8h_source.html#l00059">nbgl_flow.h:59</a></div></div>
<div class="ttc" id="astructnbgl__pageInfoLongPress__s_html_afad260d221831fb5304c99f1f79712e6"><div class="ttname"><a href="structnbgl__pageInfoLongPress__s.html#afad260d221831fb5304c99f1f79712e6">nbgl_pageInfoLongPress_s::icon</a></div><div class="ttdeci">const nbgl_icon_details_t * icon</div><div class="ttdoc">a buffer containing the 1BPP icon</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__flow_8h_source.html#l00061">nbgl_flow.h:61</a></div></div>
</div><!-- fragment --><p>Here is another version of the example code, using a callback mechanism to get tag/value pairs:</p>
<div class="fragment"><div class="line"><span class="comment">// common tag/value pair to return</span></div>
<div class="line"><span class="keyword">static</span> <a class="code hl_struct" href="structnbgl__layoutTagValue__t.html">nbgl_layoutTagValue_t</a> pair;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <a class="code hl_struct" href="structnbgl__layoutTagValue__t.html">nbgl_layoutTagValue_t</a>* getPair(<a class="code hl_typedef" href="usbd__conf_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> index);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <a class="code hl_struct" href="structnbgl__layoutTagValueList__t.html">nbgl_layoutTagValueList_t</a> pairList = {</div>
<div class="line">  .<a class="code hl_variable" href="structnbgl__layoutTagValueList__t.html#a98c7f993e468e913e5b7cad7c2fdd429">nbMaxLinesForValue</a> = 0,</div>
<div class="line">  .nbPairs = 4,</div>
<div class="line">  .pairs = NULL, <span class="comment">// to indicate that callback should be used</span></div>
<div class="line">  .callback = getPair,</div>
<div class="line">  .startIndex = 0</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// result of the rejection choice</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> onConfirmAbandon(<span class="keywordtype">void</span>) {</div>
<div class="line">  <span class="comment">// display a status page and go back to main</span></div>
<div class="line">  nbgl_useCaseStatus(<span class="stringliteral">&quot;Transaction rejected&quot;</span>,<span class="keyword">false</span>,appMain);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// called when long press button on 3rd page is long-touched or when reject footer is touched</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> reviewChoice(<span class="keywordtype">bool</span> confirm) {</div>
<div class="line">  <span class="keywordflow">if</span> (confirm) {</div>
<div class="line">    <span class="comment">// display a status page and go back to main</span></div>
<div class="line">    nbgl_useCaseStatus(<span class="stringliteral">&quot;TRANSACTION\nSIGNED&quot;</span>,<span class="keyword">true</span>,appMain);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> {</div>
<div class="line">    <span class="comment">// display a confirmation to confirm/cancel rejection</span></div>
<div class="line">    nbgl_useCaseConfirm(<span class="stringliteral">&quot;Reject transaction?&quot;</span>,<span class="stringliteral">&quot;Yes, Reject&quot;</span>,<span class="stringliteral">&quot;Go back to transaction&quot;</span>,onConfirmAbandon);</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// function called by NBGL to get the pair indexed by &quot;index&quot;</span></div>
<div class="line"><span class="keyword">static</span> <a class="code hl_struct" href="structnbgl__layoutTagValue__t.html">nbgl_layoutTagValue_t</a>* getPair(<a class="code hl_typedef" href="usbd__conf_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> index) {</div>
<div class="line">  <span class="keywordflow">switch</span> (index) {</div>
<div class="line">  <span class="keywordflow">case</span> 0:</div>
<div class="line">    pair.<a class="code hl_variable" href="structnbgl__layoutTagValue__t.html#a47cb9873bd87842612eb1dc20ce73341">item</a> = <span class="stringliteral">&quot;To&quot;</span>;</div>
<div class="line">    pair.<a class="code hl_variable" href="structnbgl__layoutTagValue__t.html#a067d5542be3bad8b47ca825affb33640">value</a> = <span class="stringliteral">&quot;0x123456&quot;</span>;</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">case</span> 1:</div>
<div class="line">    pair.<a class="code hl_variable" href="structnbgl__layoutTagValue__t.html#a47cb9873bd87842612eb1dc20ce73341">item</a> = <span class="stringliteral">&quot;From&quot;</span>;</div>
<div class="line">    pair.<a class="code hl_variable" href="structnbgl__layoutTagValue__t.html#a067d5542be3bad8b47ca825affb33640">value</a> = <span class="stringliteral">&quot;0x654321&quot;</span>;</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">case</span> 2:</div>
<div class="line">    pair.<a class="code hl_variable" href="structnbgl__layoutTagValue__t.html#a47cb9873bd87842612eb1dc20ce73341">item</a> = <span class="stringliteral">&quot;Amount&quot;</span>;</div>
<div class="line">    pair.<a class="code hl_variable" href="structnbgl__layoutTagValue__t.html#a067d5542be3bad8b47ca825affb33640">value</a> = <span class="stringliteral">&quot;1.2345 BTC&quot;</span>;</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">case</span> 3:</div>
<div class="line">    pair.<a class="code hl_variable" href="structnbgl__layoutTagValue__t.html#a47cb9873bd87842612eb1dc20ce73341">item</a> = <span class="stringliteral">&quot;Fees&quot;</span>;</div>
<div class="line">    pair.<a class="code hl_variable" href="structnbgl__layoutTagValue__t.html#a067d5542be3bad8b47ca825affb33640">value</a> = <span class="stringliteral">&quot;0.1 BTC&quot;</span>;</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">return</span> &amp;pair;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> reviewContinue(<span class="keywordtype">void</span>) {</div>
<div class="line">  <span class="keyword">static</span> <a class="code hl_struct" href="structnbgl__pageInfoLongPress__s.html">nbgl_pageInfoLongPress_t</a> infoLongPress = {</div>
<div class="line">    .<a class="code hl_variable" href="structnbgl__pageInfoLongPress__s.html#afad260d221831fb5304c99f1f79712e6">icon</a> = &amp;myAppIcon,</div>
<div class="line">    .text = <span class="stringliteral">&quot;Confirm transaction\nMyAppCoin send&quot;</span>,</div>
<div class="line">    .longPressText = <span class="stringliteral">&quot;Hold to send&quot;</span></div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// static review, providing the whole list of pairs</span></div>
<div class="line">  <a class="code hl_function" href="nbgl__use__case_8h.html#a6c43db694bb58022d8e27dbf5e1f85b6">nbgl_useCaseStaticReview</a>(&amp;pairList, &amp;infoLongPress, <span class="stringliteral">&quot;Reject transaction&quot;</span>, reviewChoice);</div>
<div class="line">}</div>
<div class="ttc" id="astructnbgl__layoutTagValue__t_html_a067d5542be3bad8b47ca825affb33640"><div class="ttname"><a href="structnbgl__layoutTagValue__t.html#a067d5542be3bad8b47ca825affb33640">nbgl_layoutTagValue_t::value</a></div><div class="ttdeci">const char * value</div><div class="ttdoc">string giving the value name</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__layout_8h_source.html#l00220">nbgl_layout.h:220</a></div></div>
<div class="ttc" id="astructnbgl__layoutTagValue__t_html_a47cb9873bd87842612eb1dc20ce73341"><div class="ttname"><a href="structnbgl__layoutTagValue__t.html#a47cb9873bd87842612eb1dc20ce73341">nbgl_layoutTagValue_t::item</a></div><div class="ttdeci">const char * item</div><div class="ttdoc">string giving the tag name</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__layout_8h_source.html#l00219">nbgl_layout.h:219</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="use_case_spinner"></a>
Spinner Use Case</h2>
<p><img src="UseCase-Spinner.png" alt="" height="300" class="inline" title="caption"/></p>
<p>When an address needs to be confirmed, it can be displayed in a Address Confirmation Use Case, at first as simple page with the raw address (as text) and a black button/Footer pair to choose to confirm or reject the address.</p>
<p>An extra button under the raw address enables to open a modal page to see the address as a QR code.</p>
<p>The <a class="el" href="nbgl__use__case_8h.html#a6c70e8409832531cb83c75c5c376ee18">nbgl_useCaseSpinner()</a> function enables to create such a page, with the following parameters:</p>
<h1><a class="anchor" id="use_case_refresh_page"></a>
Refreshing screen</h1>
<p>After having drawn graphic objects in <b>framebuffer</b>, all functions of this API automatically refresh the screen. So no need to call <a class="el" href="nbgl__obj_8h.html#a2c321e01f64784c5249e594b795bf252">nbgl_refresh()</a>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>
